let
    Source = Sql.Database("hw-crsrpt", "crs_interface", [Query="declare @Startdate datetime='1/1/2023'#(lf)#(tab)#(tab),@EndDate datetime=getdate()   ---'9/28/2023'#(lf)#(lf)--Uncollectable query#(lf)Select #(lf)#(tab)Account_Number=agency_id#(lf)#(tab),Consumer_Number=cn.cnsmr_idntfr_agncy_id#(lf)#(tab),Action_Code =ac.actn_cd_shrt_val_txt#(lf)#(tab),Result_Code=rc.rslt_cd_shrt_val_txt#(lf)#(tab),Resolution = case when rc.rslt_cd_shrt_val_txt in ('BOC','RtrnAcct','SENDVOD','VODAdd','VODQC') then 'Collectable'#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)when rc.rslt_cd_shrt_val_txt in ('BOCMAIL','Dispute','DOCRQST','EscRvw','MISCRQST','Note','PndAtty','PndFrd','SendDcsM','SIF','PIF') then 'Transactional'#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)when rc.rslt_cd_shrt_val_txt in ('CLNTUNRS','SOLDPROP','ClsExpNY','ClsdOOS','NODOCS','SHA') then 'Uncollectable'#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)when rc.rslt_cd_shrt_val_txt in ('Dispute') then 'Dispute Received'#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)    when rc.rslt_cd_shrt_val_txt in ('SendDocs') then 'VOD Request'#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab) else '' end#(lf)#(tab),[User] =ur.usr_nm_frst_txt + ' ' + ur.usr_nm_lst_txt#(lf)#(tab),[Date]=l.upsrt_dttm#(lf)#(tab),Workgroup=d.desk#(lf)from debtor d (nolock)#(lf)JOIN consumer cn (nolock) on cn.cnsmr_accnt_id=d.cnsmr_accnt_id#(lf)JOIN crs5_oltp_replicated.dbo.cnsmr_accnt_ar_log l (nolock) on l.cnsmr_id = cn.cnsmr_id#(lf)JOIN crs5_oltp_replicated.dbo.actn_cd ac (nolock) on ac.actn_cd=l.actn_cd #(lf)JOIN crs5_oltp_replicated.dbo.rslt_Cd rc (nolock) on rc.rslt_cd=l.rslt_cd#(lf)JOIN crs5_oltp_replicated.dbo.usr ur (nolock) on ur.usr_id=l.[cnsmr_accnt_ar_log_crt_usr_id]#(lf)WHERE (#(lf)#(tab)#(tab)#(tab)(#(lf)#(tab)#(tab)#(tab)#(tab)ac.actn_cd_shrt_val_txt in ('SS','Dispute')#(lf)#(tab)#(tab)#(tab)#(tab)and rc.rslt_cd_shrt_val_txt in ('SOLDPROP','BOC','BOCMAIL','CLNTUNRS','Dispute','DOCRQST'#(lf)#(tab)#(tab)#(tab)#(tab),'EscRvw','MISCRQST','NODOCS','PndAtty','PndFrd','SendDcsM','SIF','PIF','VODAdd','VODQC'#(lf)#(tab)#(tab)#(tab)#(tab),'SENDVOD','ClsdOOS','ClsExpNY','Note','RtrnAcct','SHA')#(lf)#(tab)#(tab)#(tab)#(tab))#(lf)#(tab)#(tab)#(tab) or (rc.rslt_cd_shrt_val_txt in ('Dispute','SendDocs'))#(lf)#(tab) )#(lf)and l.upsrt_dttm between @StartDate and @EndDate#(lf)order by l.upsrt_dttm#(lf)#(lf)#(lf)"])
in
    Source